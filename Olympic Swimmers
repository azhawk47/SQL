CREATE TABLE swimmers (id INTEGER PRIMARY KEY, full_name TEXT, gender TEXT, born INTEGER, country TEXT, nickname TEXT);

INSERT INTO swimmers VALUES (1, "Michael Phelps", "Male", 1985, "USA", "The GOAT");
INSERT INTO swimmers VALUES (2, "Mark Spitz", "Male", 1950, "USA", "Mark the Shark");
INSERT INTO swimmers VALUES (3, "Ian Thorpe", "Male", 1982, "Australia", "Thorpedo");
INSERT INTO swimmers VALUES (4, "Aleksandr Popov", "Male", 1971, "Russia", "The Russian Rocket");
INSERT INTO swimmers VALUES (5, "Pieter van den Hoogenband", "Male", 1978, "Netherlands", "The Flying Dutchman");
INSERT INTO swimmers VALUES (6, "Katinka Hosszú", "Female", 1989, "Hungary", "Iron Lady");
INSERT INTO swimmers VALUES (7, "Katie Ledecky", "Female", 1997, "USA", "First Lady of Freestyle");
INSERT INTO swimmers VALUES (8, "Krisztina Egerszegi", "Female", 1974, "Hungary", "Little Mouse");
INSERT INTO swimmers VALUES (9, "Kristin Otto", "Female", 1966, "Germany", "None");
INSERT INTO swimmers VALUES (10, "Dara Torres", "Female", 1967, "USA", "DT");

CREATE TABLE olympics (id INTEGER PRIMARY KEY, full_name TEXT, medal_count INTEGER, first_olympics INTEGER, last_olympics INTEGER, total_olympics INTEGER);

INSERT INTO olympics VALUES (1, "Michael Phelps", 28, 2000, 2016, 5);
INSERT INTO olympics VALUES (2, "Mark Spitz", 11, 1968, 1972, 2);
INSERT INTO olympics VALUES (3, "Ian Thorpe", 9, 2000, 2004, 2);
INSERT INTO olympics VALUES (4, "Aleksandr Popov", 9, 1992, 2000, 3);
INSERT INTO olympics VALUES (5, "Pieter van den Hoogenband", 17, 1996, 2008, 4);
INSERT INTO olympics VALUES (6, "Katinka Hosszú", 4, 2004, 2020, 4);
INSERT INTO olympics VALUES (7, "Katie Ledecky", 10, 2012, 2020, 3);
INSERT INTO olympics VALUES (8, "Krisztina Egerszegi", 7, 1988, 1996, 3);
INSERT INTO olympics VALUES (9, "Kristin Otto", 6, 1988, 1988, 1);
INSERT INTO olympics VALUES (10, "Dara Torres", 12, 1984, 2008, 5);

CREATE TABLE specialties (id INTEGER PRIMARY KEY, full_name TEXT, primary_stroke TEXT, secondary_stroke TEXT, distance TEXT);

INSERT INTO specialties VALUES (1, "Michael Phelps", "Butterfly", "Freestyle", "Mid");
INSERT INTO specialties VALUES (2, "Mark Spitz", "Butterfly", "Freestyle", "Mid/Sprint");
INSERT INTO specialties VALUES (3, "Ian Thorpe", "Freestyle", NULL, "Mid");
INSERT INTO specialties VALUES (4, "Aleksandr Popov", "Freestyle", NULL, "Sprint");
INSERT INTO specialties VALUES (5, "Pieter van den Hoogenband", "Freestyle", NULL, "Mid/Sprint");
INSERT INTO specialties VALUES (6, "Katinka Hosszú", "Individual Medley", "Backstroke", "Mid");
INSERT INTO specialties VALUES (7, "Katie Ledecky", "Freestyle", NULL, "Distance");
INSERT INTO specialties VALUES (8, "Krisztina Egerszegi", "Backstroke", NULL, "Mid/Srint");
INSERT INTO specialties VALUES (9, "Kristin Otto", "Freestyle", "Backstroke", "Mid/Sprint");
INSERT INTO specialties VALUES (10, "Dara Torres", "Freestyle", NULL, "Sprint");

SELECT * FROM swimmers;
SELECT * FROM olympics;
SELECT * FROM specialties;

SELECT swimmers.full_name, swimmers.country, olympics.medal_count, olympics.total_olympics 
    FROM swimmers
    JOIN olympics
    ON swimmers.full_name = olympics.full_name
    ORDER BY olympics.medal_count DESC;
    
SELECT swimmers.full_name, swimmers.nickname, olympics.medal_count, specialties.primary_stroke
    FROM swimmers
    JOIN olympics
    ON swimmers.full_name = olympics.full_name
    JOIN specialties
    ON swimmers.full_name = specialties.full_name
    ORDER BY olympics.medal_count DESC;

SELECT swimmers.full_name, swimmers.nickname, olympics.medal_count, specialties.primary_stroke
    FROM swimmers
    JOIN olympics
    ON swimmers.full_name = olympics.full_name
    JOIN specialties
    ON swimmers.full_name = specialties.full_name
    WHERE swimmers.country IN ("USA")
    ORDER BY olympics.medal_count DESC;
